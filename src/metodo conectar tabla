public class DBTableModel {

    // Método para llenar una JTable con datos de una base de datos
    public static void fillTableFromDB(JTable table) {
        DefaultTableModel model = (DefaultTableModel) table.getModel();
        model.setRowCount(0); // Limpiar la tabla antes de agregar nuevos datos

        try {
            // Establecer la conexión a la base de datos
            Connection connection = DB.conectar(); // Reemplaza esto con tu método para conectar a la base de datos

            // Consulta SQL para seleccionar todos los registros de la tabla 'peliculas'
            String query = "SELECT * FROM peliculas"; 

            // Crear la declaración PreparedStatement
            PreparedStatement statement = connection.prepareStatement(query);

            // Ejecutar la consulta y obtener el resultado
            ResultSet resultSet = statement.executeQuery();

            // Iterar sobre el resultado y agregar cada fila a la tabla
            while (resultSet.next()) {
                Object[] row = new Object[] {
                    resultSet.getInt("id"),
                    resultSet.getString("nombre"),
                    resultSet.getDate("fecha_lanzamiento"),
                    resultSet.getString("director"),
                    resultSet.getString("categoria"),
                    resultSet.getInt("duracion")
                };
                model.addRow(row); // Agregar la fila al modelo de la tabla
            }

            // Cerrar recursos
            resultSet.close();
            statement.close();
            connection.close();
        } catch (SQLException ex) {
            ex.printStackTrace();
            // Manejar cualquier excepción de SQL aquí
        }
    }
}